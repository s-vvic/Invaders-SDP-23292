name: Backend Node.js CI

on:
  pull_request: # PR이 생성되거나 업데이트될 때마다 실행
    branches: [ master, dev ] # master 또는 dev 브랜치를 대상으로 하는 PR에 대해 실행
    paths:
      - 'backend/**' # backend 폴더 내 파일 변경 시에만 실행 (효율성)
  push:
    branches: [ master ] # master 브랜치에 push될 때 실행

jobs:
  build_and_test_backend:
    name: Build & Test (Backend)
    runs-on: ubuntu-latest # 실행 환경 (최신 우분투 VM)

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4 # 저장소 코드 체크아웃

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # Node.js 버전 지정 (팀에서 사용하는 버전으로 변경 가능)

      - name: Install Dependencies
        run: npm install # package.json 기반 의존성 설치
        working-directory: ./backend # backend 폴더 내에서 명령어 실행

      # - name: Run Tests
      #   run: npm test # 테스트 명령어 실행 (package.json에 test 스크립트가 정의되어 있어야 함)
      #   working-directory: ./backend
      #   env:
      #     JWT_SECRET: ${{ secrets.JWT_SECRET }} # IDE lint: disable
        
      # 만약 빌드 과정이 필요하다면 아래 주석 해제 (예: Babel 또는 Webpack 사용 시)
      # - name: Build Project
      #   run: npm run build
      #   working-directory: ./backend
